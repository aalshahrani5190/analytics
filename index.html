<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>بوابة المؤشرات التنفيذية</title>

<!-- خط عربي (Cairo) من Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --brand-dark:#0f5132;    /* أخضر غامق */
    --brand-mid:#1b6f4a;     /* أخضر متوسط */
    --accent:#c79a2b;        /* ذهبي/عنابي فاتح للـ highlights */
    --bg:#f3f5f2;            /* خلفية عامة */
    --card:#ffffff;          /* خلفية البطاقات */
    --muted:#7d7d7d;        /* نص ثانوي */
    --radius:12px;
    --max-width:1200px;
  }

  html,body { height:100%; }
  body{
    margin:0;
    font-family: "Cairo", Tahoma, Arial, sans-serif;
    background:var(--bg);
    color:#222;
    direction:rtl;
  }

  header.site-header{
    background:var(--brand-dark);
    color:#fff;
    padding:18px 16px;
    text-align:center;
    font-size:20px;
    font-weight:600;
    box-shadow:0 2px 6px rgba(0,0,0,.08);
  }

  .container{
    max-width:var(--max-width);
    margin:26px auto;
    padding:0 18px;
  }

  .top-actions{
    display:flex;
    gap:12px;
    justify-content:center;
    align-items:center;
    margin:18px 0 8px;
  }

  .open-btn{
    background:var(--brand-mid);
    color:#fff;
    border:none;
    padding:10px 18px;
    border-radius:8px;
    cursor:pointer;
    font-weight:600;
    box-shadow:0 4px 10px rgba(11,67,45,.12);
    text-decoration:none;
  }

  .open-btn:hover{ transform:translateY(-2px); }

  /* بطاقة توضيح */
  .note{
    max-width:var(--max-width);
    margin:8px auto 18px;
    padding:12px 16px;
    background:linear-gradient(180deg, rgba(255,255,255,0.9), rgba(250,250,250,0.9));
    border-radius:10px;
    border:1px solid rgba(0,0,0,0.04);
    color:var(--muted);
    font-size:14px;
    text-align:center;
  }

  /* إطار التقرير */
  .report-wrap{
    background:var(--card);
    border-radius:var(--radius);
    overflow:hidden;
    border:1px solid rgba(0,0,0,0.06);
    box-shadow:0 8px 22px rgba(8,23,13,0.06);
  }

  /* responsive iframe */
  .report-frame{
    width:100%;
    height:75vh; /* ارتفاع افتراضي */
    border:0;
    display:block;
  }

  /* Footer small */
  footer{
    text-align:center;
    color:var(--muted);
    font-size:13px;
    margin:18px 0 40px;
  }

  /* Mobile adjustments */
  @media (max-width:900px){
    .report-frame{ height:65vh; }
    header.site-header{ font-size:18px; padding:14px 10px; }
    .open-btn{ padding:8px 14px; }
    .note{ font-size:13px; padding:10px; }
  }

</style>
</head>
<body>

<header class="site-header">بوابة المؤشرات التنفيذية</header>

<div class="container">

  <div class="top-actions">
    <!-- زر لفتح التقرير في نافذة/تبويب جديد -->
    <a class="open-btn" id="openNewTab" target="_blank" rel="noopener noreferrer" href="https://app.powerbi.com/reportEmbed?reportId=defd8305-2125-44b3-805f-035cfdc3b96d&autoAuth=true&ctid=79a057fb-b0d5-44dd-8f90-0bf7151f5c3f&actionBarEnabled=true&reportCopilotInEmbed=true">
      افتح لوحة المؤشرات (Power BI)
    </a>
  </div>

  <div class="note">
    تم تضمين لوحة Power BI أدناه. إن لم تظهر التبويبات أو العناصر التفاعلية داخلياً، اضغط زر "افتح لوحة المؤشرات" لفتحها في نافذة جديدة.
  </div>

  <div class="report-wrap" role="region" aria-label="لوحة مؤشرات Power BI">
    <!--
      استبدل قيمة src بالرابط الوحيد الذي أرسلته (رابط embed لـ Power BI).
      لاحظ: بعض إعدادات Power BI أو سياسات المؤسسة قد تمنع العمل الكامل داخل iframe.
      استخدم الزر لفتح التقرير في علامة تبويب جديدة إذا لزم الأمر.
    -->
    <iframe
      id="reportFrame"
      class="report-frame"
      src="https://app.powerbi.com/reportEmbed?reportId=defd8305-2125-44b3-805f-035cfdc3b96d&autoAuth=true&ctid=79a057fb-b0d5-44dd-8f90-0bf7151f5c3f&actionBarEnabled=true&reportCopilotInEmbed=true"
      title="لوحة مؤشرات الربحية - Power BI"
      allowfullscreen
      sandbox="allow-forms allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"
    ></iframe>
  </div>

  <footer>
    © بوابة المؤشرات — عرض مضمَّن من Power BI. تحتاج إلى صلاحية دخول Microsoft / Power BI لعرض التقرير كاملاً.
  </footer>

</div>

<script>
  // إذا رغبت: يمكن استخدام هذا السكربت لتحديث src ديناميكياً
  // حالياً نستخدم رابطاً واحداً موحّداً كما طلبت.
  (function(){
    const embedUrl = "https://app.powerbi.com/reportEmbed?reportId=defd8305-2125-44b3-805f-035cfdc3b96d&autoAuth=true&ctid=79a057fb-b0d5-44dd-8f90-0bf7151f5c3f&actionBarEnabled=true&reportCopilotInEmbed=true";
    // تعيين الرابط على الزر (في حال تغيّر لاحقاً)
    const openBtn = document.getElementById('openNewTab');
    if(openBtn) openBtn.href = embedUrl;

    // إذا أردت تغيير الiframe لاحقاً برمجياً:
    // document.getElementById('reportFrame').src = embedUrl;
  })();
</script>

</body>
</html>
